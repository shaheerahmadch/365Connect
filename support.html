<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description"
        content="365Connect is a community dedicated to promoting and advancing the adoption of Microsoft D365 and Power Platform technologies. Our primary goal is to foster a supportive environment where individuals can learn, teach, and collaborate on all things related to these powerful tools. Whether you're an experienced user or just starting out, we welcome members from any part of the globe to join us in our mission to promote and develop this community.">
    <meta name="author" content="Shaheer Ahmad">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:100,200,300,400,500,600,700,800,900"
        rel="stylesheet">


    <!-- Bootstrap core CSS -->

    <!-- Additional CSS Files -->
    <link rel="stylesheet" href="assets/css/fontawesome.css">
    <link rel="stylesheet" href="assets/css/templatemo-grad-school.css">
    <link rel="stylesheet" href="assets/css/owl.css">
    <link rel="stylesheet" href="assets/css/lightbox.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Support | 365Connect Community</title>
    <link rel="stylesheet" href="styles.css">

    <script src="vendor/jquery/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://code.jquery.com/jquery-3.3.1.slim.min.js">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.bundle.min.js">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

</head>

<body>
    <header class="main-header clearfix" role="header">
        <div class="logo">
            <img id="header-logo" style="height: 50px; margin-right: 20px;" src="./favicon.ico">
            <a href="#" style="text-decoration: none; font-size: 29px !important;"><em></em><span
                    style="color: #feb70c;">3</span><span style="color: #5ea904;">6</span><span
                    style="color: #04a0ed;">5</span><span style="color: white;">C</span><span
                    style="text-transform: lowercase;">onnect</span></a><!--#ce392c;-->
        </div>
        <a href="#menu" class="menu-link"><i class="fa fa-bars"></i></a>
        <nav id="menu" class="main-nav" role="navigation">
            <ul class="main-menu">
                <li class="active"><a style="text-decoration: none !important;" href="./support.html"
                        class="external">Support</a></li>
                <li><a style="text-decoration: none !important;" href="./index.html">Home</a></li>
                <!--
            <li class="has-submenu"><a href="#section2">About Us</a>
              <ul class="sub-menu">
                <li><a href="#section2">Who we are?</a></li>
                <li><a href="#section3">What we do?</a></li>
                <li><a href="#section3">How it works?</a></li>
                <li><a href="https://templatemo.com/about" rel="sponsored" class="external">External URL</a></li>
              </ul>
            </li>-->
                <!-- <li><a href="#section5">Video</a></li> -->
                <li><a style="text-decoration: none !important;" href="./events.html" class="external">Events</a></li>
            </ul>
        </nav>
    </header>
    <div class="loading" id="loading">Loading&#8230;</div>
    <div class="header" style="height: 50vh !important;">


        <div class="sides">
            <!-- search-->
            <a href="./index.html" class="logo">ðŸ”™ </a>
            <!-- search end-->
            <a href="#" class="logo" style="display: none;">Events</a>
        </div>


        <div class="sides">
            <a href="#" class="menu" style=" display: none;"> </a>


        </div>
        <div class="info" style="padding: 0 !important;">
            <h4><a href="https://www.linkedin.com/in/shaheer-ahmad-ch/"></a></h4>
            <h2>365Connect Community</h2>
            <div class="meta">
                <a href="https://www.linkedin.com/company/365-connect-community" target="_b" class="author"></a><br>
                <a href="https://www.linkedin.com/in/shaheer-ahmad-ch" target="_b"></a>
            </div>
        </div>
    </div>

    <section class="content" style="width: 100% !important;padding: 0px !important;">

        <div class="event-detail" id="event-detail" style="width: 100% !important;">
            <ul id="event-list" style="width: 100% !important;"></ul><br>

        </div>
        </div>
        <div class="container" style="width: 70% !important;" id="container">

            <form class="well form-horizontal" action=" " method="post" id="contact_form">
                <fieldset>
                    <center>
                        <br>
                        <h2 style="color: white !important;">Support Request</h2>
                        <hr style=" border: 2px solid white; border-radius: 20px;">
                        <br>
                    </center>
                    <!-- Form Name -->


                    <!-- Text input-->

                    <div class="form-group">
                        <label class="col-md-4 control-label"
                            style="margin-bottom:10px !important; margin-top: 10px !important; font-weight: 600;color: white !important;">Full
                            Name</label>
                        <div class="col-md-4 inputGroupContainer" style="width: 100% !important;">
                            <div class="input-group" style="height: 50px !important; margin-bottom:10px !important;">
                                <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                                <input name="first_name" placeholder="" id="name" class="form-control" type="text">
                            </div>
                        </div>
                    </div>

                    <!-- Text input-->

                    <!-- Text input-->
                    <div class="form-group">
                        <label class="col-md-4 control-label"
                            style="margin-bottom:10px !important; margin-top: 10px !important; font-weight: 600;color: white !important;">E-Mail</label>
                        <div class="col-md-4 inputGroupContainer" style="width: 100% !important;">
                            <div class="input-group" style="height: 50px !important; margin-bottom:10px !important;">
                                <span class="input-group-addon"><i class="glyphicon glyphicon-envelope"></i></span>
                                <input name="email" placeholder="" id="email" class="form-control" type="text">
                            </div>
                        </div>
                    </div>


                    <!-- Text input-->

                    <div class="form-group">
                        <label class="col-md-4 control-label"
                            style="margin-bottom:10px !important; margin-top: 10px !important; font-weight: 600;color: white !important;">Subject</label>
                        <div class="col-md-4 inputGroupContainer" style="width: 100% !important;">
                            <div class="input-group" style="height: 50px !important; margin-bottom:10px !important;">
                                <span class="input-group-addon"><i class="glyphicon glyphicon-earphone"></i></span>
                                <input name="phone" placeholder="" id="subject" class="form-control" type="text">
                            </div>
                        </div>
                    </div>
                    <div class="form-group" style="height: 150px !important;">
                        <label class="col-md-4 control-label"
                            style="margin-bottom:10px !important; margin-top: 10px !important; font-weight: 600;color: white !important;">Support
                            Message</label>
                        <div class="col-md-4 inputGroupContainer" style="width: 100% !important;">
                            <div class="input-group" style="height: 50px !important; margin-bottom:10px !important;">
                                <span class="input-group-addon"><i class="glyphicon glyphicon-earphone"></i></span>
                                <textarea name="phone" placeholder="" id="message" style="height: 150px !important;"
                                    class="form-control" type="text"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Text input-->

                    <br><br>
                    <div class="message" id="message">
                    </div>
                    <!-- Success message -->

                    <!-- Button -->
                    <div class="form-group">
                        <label class="col-md-4 control-label"></label>
                        <div class="col-md-4">
                            <p class="btn btn-primary btn-lg" onclick="submitForm()" style="background-color: orange !important; border-color: orange !important;" id="submit-button">Submit <span
                                    class="glyphicon glyphicon-send"></span></p>
                        </div>
                    </div>

                </fieldset>
            </form>
        </div>
        <br><br><br>
        </div><!-- /.container -->
        <div class="message" id="message">
        </div>

    </section>
    <!-- Site footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <p><i class="fa fa-copyright"></i> Copyright 2023 by 365Connect Community

                        | Design: <a href="https://www.linkedin.com/in/shaheer-ahmad-ch" rel="sponsored"
                            target="_parent">Shaheer Ahmad</a></p>
                </div>
            </div>
        </div>
    </footer>

    <script>
        
        const email = sessionStorage.getItem("email");
        const fullname = sessionStorage.getItem("name");

        const sidesDiv = document.querySelector(".main-menu");

        // Create a new anchor element
        const link = document.createElement("a");
        link.style.textDecoration = "none";
        var listItem = document.createElement("li");

        var listItem1 = document.createElement("li");
        // Set the anchor's attributes
        link.href = "./login.html";
        link.className = "external";
        const link1 = document.createElement("a");

        // Set the anchor's attributes
        link1.href = "./login.html";
        link1.className = "external";
        link1.style.textDecoration = "none";
        link1.textContent = "Sign Out";
        link1.addEventListener("click", function (event) {
            event.preventDefault();
            sessionStorage.setItem("name", null);
            sessionStorage.setItem("email", null);
            sessionStorage.setItem("image", null);
            window.location.href = "./index.html";
        });
        if (sessionStorage.getItem("name") == null || sessionStorage.getItem("email") == null || sessionStorage.getItem("email") == 'null' || sessionStorage.getItem("name") == 'null' || sessionStorage.getItem("email") == '' || sessionStorage.getItem("name") == '') {
            link.textContent = "Sign-In";
            listItem.appendChild(link);
            sidesDiv.appendChild(listItem);
            window.location.href = "./login.html"

        }
        else {
            link.textContent = fullname.split(' ')[0] + ", Profile";
            listItem.appendChild(link);
            sidesDiv.appendChild(listItem);
            listItem1.appendChild(link1);
            sidesDiv.appendChild(listItem1)
        }




        if (sessionStorage.getItem("name") == null || sessionStorage.getItem("email") == null || sessionStorage.getItem("email") == 'null' || sessionStorage.getItem("name") == 'null' || sessionStorage.getItem("email") == '' || sessionStorage.getItem("name") == '') {
            console.log("notsignedin")
        } else {
            document.getElementById("email").value = email;
            document.getElementById("name").value = fullname;
            document.getElementById("email").disabled = true;
            document.getElementById("name").disabled = true;
        }
        document.getElementById("loading").style.display = "none";

        ///// form
        function submitForm() {
            document.getElementById("loading").style.display = "block";
            var myDiv = document.getElementById("message");
            var headingToDelete = document.querySelector(".alert");
            if (headingToDelete) {
                myDiv.removeChild(headingToDelete);
            }
            var myDiv = document.getElementById("message");
            var headingToDelete = document.querySelector(".alert");
            if (headingToDelete) {
                myDiv.removeChild(headingToDelete);
            }
            var myDiv = document.getElementById("message");
            var headingToDelete = document.querySelector(".alert");
            if (headingToDelete) {
                myDiv.removeChild(headingToDelete);
            }

            var name = document.getElementById("name").value
            var email = document.getElementById("email").value
            var subject = document.getElementById("subject").value
            var message = document.getElementById("message").value

            if (name == '') {
                showError("Name is Required", "danger")
                document.getElementById("loading").style.display = "none";

            }
            if (email == '') {
                showError("Email is Required", "danger")
                document.getElementById("loading").style.display = "none";

            }
            if (subject == '') {
                showError("Subject is Required", "danger")
                document.getElementById("loading").style.display = "none";

            }
            if (message == '') {
                showError("Message is Required", "danger")
                document.getElementById("loading").style.display = "none";

            }
            if (name != '' && email != '' && message != '' && subject != '') {
                document.getElementById("loading").style.display = "block";

                var myHeaders = new Headers();
                myHeaders.append("name", name);
                myHeaders.append("email", email);
                myHeaders.append("subject", subject);
                myHeaders.append("message", message);

                var requestOptions = {
                    method: 'POST',
                    headers: myHeaders,
                    redirect: 'follow'
                };

                fetch("https://prod-47.southeastasia.logic.azure.com:443/workflows/46b0074054a84e919e0c6ed8c656aa76/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=dx3YJpOrWCsYEZp_53p8uUFz1xZjLf4wz4DKGzwiH1o", requestOptions)
                    .then(response => {
                        if (response.status === 200) {
                            // Registration was successful
                            alert("Success. Your request has been sent. You'll recieve an email shortly");
                            showError("Success. Your request has been sent. You'll recieve an email shortly", "success");
                            document.getElementById("loading").style.display = "none";
                        } else {
                            // Handle other response codes (e.g., display an error message)
                            alert("Error.")
                            showError("Error.", "danger")
                            document.getElementById("loading").style.display = "none";
                        }
                    })
                    .then(result => {
                        alert("Success. Your request has been sent. You'll recieve an email shortly");
                        showError("Success. Your request has been sent. You'll recieve an email shortly", "success");
                        // Do something with the result (e.g., display a success message)
                        console.log('Registration Successful:', result);
                    })
                    .catch(error => {
                        // Handle errors here (e.g., display an error message)
                        alert("Error.")
                        console.error('Error:', error.message);
                        showError("Error.", "danger");
                    });



                document.getElementById("name").disabled = true;
                document.getElementById("email").disabled = true;
                document.getElementById("subject").disabled = true;
                document.getElementById("message").disabled = true;
                document.getElementById("submit-button").style.display = "none";

            }



        };
        function showError(alert, alertType) {
            var message = document.getElementById("message");
            var messagetext = document.createElement("div");
            messagetext.classList.add("alert")
            messagetext.classList.add("alert-" + alertType)
            messagetext.textContent = alert;
            message.appendChild(messagetext);
        }
        
        if (screen.height > screen.width){
            document.getElementById("header-logo").hidden = true;
        document.querySelector(".menu-link").classList.remove("active");
        document.querySelector(".main-nav").classList.remove("active");
        document.querySelector(".main-menu").hidden = true;
        document.querySelector(".fa").addEventListener("click", function () {
            if(document.querySelector(".menu-link").classList.value.includes("active")){
                document.querySelector(".menu-link").classList.remove("active");
                document.querySelector(".main-nav").classList.remove("active");
                document.querySelector(".main-menu").hidden = false;
            }
            else{
            document.querySelector(".menu-link").classList.add("active");
            document.querySelector(".main-nav").classList.add("active");
            document.querySelector(".main-menu").hidden = true;
            }
        })
    }


    </script>

</body>

</html>