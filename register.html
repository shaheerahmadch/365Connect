<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="365Connect is a community dedicated to promoting and advancing the adoption of Microsoft D365 and Power Platform technologies. Our primary goal is to foster a supportive environment where individuals can learn, teach, and collaborate on all things related to these powerful tools. Whether you're an experienced user or just starting out, we welcome members from any part of the globe to join us in our mission to promote and develop this community.">
    <meta name="author" content="Shaheer Ahmad">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:100,200,300,400,500,600,700,800,900" rel="stylesheet">

    
    <!-- Bootstrap core CSS -->

    <!-- Additional CSS Files -->
    <link rel="stylesheet" href="assets/css/fontawesome.css">
    <link rel="stylesheet" href="assets/css/templatemo-grad-school.css">
    <link rel="stylesheet" href="assets/css/owl.css">
    <link rel="stylesheet" href="assets/css/lightbox.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register | 365Connect Community</title>
    <link rel="stylesheet" href="styles.css">
    
    <script src="vendor/jquery/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://code.jquery.com/jquery-3.3.1.slim.min.js">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.bundle.min.js">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

</head>

<body>
    <header class="main-header clearfix" role="header">
        <div class="logo">
          <a style="text-decoration: none !important; font-size: 29px !important;" href="#"><em>365</em>Connect</a>
        </div>
        <a href="#menu" class="menu-link"><i class="fa fa-bars"></i></a>
        <nav id="menu" class="main-nav" role="navigation">
          <ul class="main-menu">
            <li><a style="text-decoration: none !important;" href="./index.html">Home</a></li>
            <!--
            <li class="has-submenu"><a href="#section2">About Us</a>
              <ul class="sub-menu">
                <li><a href="#section2">Who we are?</a></li>
                <li><a href="#section3">What we do?</a></li>
                <li><a href="#section3">How it works?</a></li>
                <li><a href="https://templatemo.com/about" rel="sponsored" class="external">External URL</a></li>
              </ul>
            </li>-->
            <!-- <li><a href="#section5">Video</a></li> -->
            <li><a style="text-decoration: none !important;" href="./events.html" class="external">Events</a></li>
            <li><a style="text-decoration: none !important;" href="./support.html" class="external">Support</a></li>
          </ul>
        </nav>
      </header>

    <div class="loading" id="loading">Loading&#8230;</div>
    <div class="header" style="height: 50vh !important;">


        <div class="sides">
            <!-- search-->
            <a href="./index.html" class="logo">ðŸ”™ </a>
            <!-- search end-->
            <a href="#" class="logo" style="display: none;">Events</a>
        </div>


        <div class="sides">
            <a href="#" class="menu" style=" display: none;"> </a>


        </div>
        <div class="info" style="padding: 0 !important;">
            <h4><a href="https://www.linkedin.com/in/shaheer-ahmad-ch/"></a></h4>
            <h2>365Connect Community</h2>
            <div class="meta">
                <a href="https://www.linkedin.com/company/365-connect-community" target="_b" class="author"></a><br>
                <a href="https://www.linkedin.com/in/shaheer-ahmad-ch" target="_b"></a>
            </div>
        </div>
    </div>

    <section class="content" style="width: 100% !important;padding: 0px !important;">

        <div class="event-detail" id="event-detail" style="width: 100% !important;">
            <ul id="event-list" style="width: 100% !important;"></ul><br>
            <center>
                <div class="message" id="message1" style="width: 60% !important;"></div>
            </center>

        </div>
        </div>
        <div class="container" style="width: 70% !important;" id="container">

            <form class="well form-horizontal" action=" " method="post" id="contact_form">
                <fieldset>
                    <center>
                        <br>
                        <h2 style="color: white !important;">Register Now</h2>
                        <hr style=" border: 2px solid white; border-radius: 20px;">
                        <br>
                    </center>
                    <!-- Form Name -->


                    <!-- Text input-->

                    <div class="form-group">
                        <label class="col-md-4 control-label"
                            style="margin-bottom:10px !important; margin-top: 10px !important; font-weight: 600;color: white !important;">First
                            Name</label>
                        <div class="col-md-4 inputGroupContainer" style="width: 100% !important;">
                            <div class="input-group" style="height: 50px !important; margin-bottom:10px !important;">
                                <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                                <input name="first_name" placeholder="" id="firstname" class="form-control" type="text">
                            </div>
                        </div>
                    </div>

                    <!-- Text input-->

                    <div class="form-group">
                        <label class="col-md-4 control-label"
                            style="margin-bottom:10px !important; margin-top: 10px !important; font-weight: 600;color: white !important;">Last
                            Name</label>
                        <div class="col-md-4 inputGroupContainer" style="width: 100% !important;">
                            <div class="input-group" style="height: 50px !important; margin-bottom:10px !important;">
                                <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                                <input name="last_name" placeholder="" id="lastname" class="form-control" type="text">
                            </div>
                        </div>
                    </div>

                    <!-- Text input-->
                    <div class="form-group">
                        <label class="col-md-4 control-label"
                            style="margin-bottom:10px !important; margin-top: 10px !important; font-weight: 600;color: white !important;">E-Mail</label>
                        <div class="col-md-4 inputGroupContainer" style="width: 100% !important;">
                            <div class="input-group" style="height: 50px !important; margin-bottom:10px !important;">
                                <span class="input-group-addon"><i class="glyphicon glyphicon-envelope"></i></span>
                                <input name="email" placeholder="" id="email" class="form-control" type="text">
                            </div>
                        </div>
                    </div>


                    <!-- Text input-->

                    <div class="form-group">
                        <label class="col-md-4 control-label"
                            style="margin-bottom:10px !important; margin-top: 10px !important; font-weight: 600;color: white !important;">Phone
                            (Optional)</label>
                        <div class="col-md-4 inputGroupContainer" style="width: 100% !important;">
                            <div class="input-group" style="height: 50px !important; margin-bottom:10px !important;">
                                <span class="input-group-addon"><i class="glyphicon glyphicon-earphone"></i></span>
                                <input name="phone" placeholder="" id="phone" class="form-control" type="text">
                            </div>
                        </div>
                    </div>

                    <!-- Text input-->

                    <br><br>
                    <div class="message" id="message">
                    </div>
                    <!-- Success message -->

                    <!-- Button -->
                    <div class="form-group">
                        <label class="col-md-4 control-label"></label>
                        <div class="col-md-4">
                            <p class="btn btn-primary btn-lg" onclick="submitForm()" id="submit-button">Register <span
                                    class="glyphicon glyphicon-send"></span></p>
                        </div>
                    </div>

                </fieldset>
            </form>
        </div>
        <br><br><br>
        </div><!-- /.container -->

        <!-- Popup and overlay for event details -->
        <div class="overlay" id="overlay"></div>
        <div class="popup" id="popup">
            <button class="close-button" id="close-popup">Close</button>
            <h2>Event Details</h2><br>
            <p><strong>Name:</strong> <span id="event-name"></span></p>
            <p><strong>Start Date:</strong> <span id="event-start"></span></p>
            <p><strong>End Date:</strong> <span id="event-end"></span></p>
            <p><strong>Status:</strong> <span id="event-status"></span></p>
            <p><strong>Type:</strong> <span id="event-type"></span></p>
            <p><strong>Description:</strong> <span id="event-description"></span></p>
            <a href="#" id="register-now-link" target="_blank"><button class="register-now">Register Now</button></a>
        </div>

    </section>
    <!-- Site footer -->
    <footer>
        <div class="container">
          <div class="row">
            <div class="col-md-12">
              <p><i class="fa fa-copyright"></i> Copyright 2023 by 365Connect Community
              
               | Design: <a href="https://www.linkedin.com/in/shaheer-ahmad-ch" rel="sponsored" target="_parent">Shaheer Ahmad</a></p>
            </div>
          </div>
        </div>
      </footer>

    <script>
        const sidesDiv = document.querySelector(".main-menu");

// Create a new anchor element
const link = document.createElement("a");
link.style.textDecoration = "none";
var listItem = document.createElement("li");

var listItem1     = document.createElement("li");
// Set the anchor's attributes
link.href = "./login.html";
link.className = "external";
const link1 = document.createElement("a");

// Set the anchor's attributes
link1.href = "./login.html";
link1.className = "external";
link1.style.textDecoration = "none";
link1.textContent = "Sign Out";
link1.addEventListener("click", function (event) {
    event.preventDefault();
    sessionStorage.setItem("name", null);
    sessionStorage.setItem("email", null);
    sessionStorage.setItem("image", null);
    window.location.href = "./index.html";
});
if (sessionStorage.getItem("name") == null || sessionStorage.getItem("email") == null || sessionStorage.getItem("email") == 'null' || sessionStorage.getItem("name") == 'null' || sessionStorage.getItem("email") == '' || sessionStorage.getItem("name") == '') {
    link.textContent = "Sign-In";
    listItem.appendChild(link);
    sidesDiv.appendChild(listItem);

}
else {
    link.textContent = fullname.split(' ')[0] + ", Profile";
    listItem.appendChild(link);
    sidesDiv.appendChild(listItem);
    listItem1.appendChild(link1);
    sidesDiv.appendChild(listItem1)
}



        
        document.getElementById("loading").style.display = "none";
        var url_string = window.location.href;
        var url = new URL(url_string);
        var id = url.searchParams.get("id");
        var showReg = url.searchParams.get("reg");
        var myHeaders = new Headers();
        myHeaders.append("guid", id);

        var requestOptions = {
            method: 'GET',
            headers: myHeaders,
            redirect: 'follow'
        };

        const apiUrl = "https://prod-54.southeastasia.logic.azure.com:443/workflows/ec084d3691234b458d24d5ec70f8e8b5/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=GenJ5EF13FI94PR3kMFN5CcC3H9jDQYAw0i2sE5Idro";

        // Function to fetch event data from the API
        async function fetchEventData() {
            try {
                const response = await fetch(apiUrl, requestOptions); // Await the fetch call
                if (response.status === 200) {
                    const data = await response.json();
                    return data;
                } else {
                    showError1("Event not found", "warning");
                    document.getElementById("container").style.display = "none";
                    return [];
                }
            } catch (error) {
                showError1("Event not found", "warning");

                document.getElementById("container").style.display = "none";
                return [];
            }
        }

        // You should call this function within an async context, e.g., inside an async function
        async function fetchData() {
            const eventList = document.getElementById("event-list");
            const event = await fetchEventData();

            if (event && event.length != 0) {
                const fragment = document.createDocumentFragment(); // Create a document fragment
                const listItem = document.createElement("li");
                listItem.className = "event-item";
                listItem.innerHTML = `<h1>${event.sa_name}</h1>
            <p> ${event.sa_description}</p><br>
            <p><strong>Speaker:</strong> ${event["_sa_host_value@OData.Community.Display.V1.FormattedValue"]}</p>
            <p><strong>Duration:</strong> ${hoursToDays(event.sa_duration)}</p>
            <p><strong>Start Date:</strong> ${event["sa_start@OData.Community.Display.V1.FormattedValue"]}</p>
            <p><strong>End Date:</strong> ${event["sa_end@OData.Community.Display.V1.FormattedValue"]}</p>
            <p><strong>Registration Open:</strong> ${event["sa_registrationopen@OData.Community.Display.V1.FormattedValue"]}</p>
            <p><strong>Status:</strong> ${event["statuscode@OData.Community.Display.V1.FormattedValue"]}</p><br>`;
                fragment.appendChild(listItem); // Append to the fragment

                eventList.appendChild(fragment); // Append the fragment to the DOM
                if(!event.sa_registrationopen){
                    document.getElementById("container").style.display = "none";
                    showError1("Registration Closed","warning")
                }
                if( showReg == 'false'){
                    document.getElementById("container").style.display = "none";
                    showError1("Already Registered","success")
                }
            }
        }

        // Call the fetchData function
        fetchData();

        ///// form
        function submitForm() {
            document.getElementById("loading").style.display = "block";
            var myDiv = document.getElementById("message");
            var headingToDelete = document.querySelector(".alert");
            if (headingToDelete) {
                myDiv.removeChild(headingToDelete);
            }
            var myDiv = document.getElementById("message");
            var headingToDelete = document.querySelector(".alert");
            if (headingToDelete) {
                myDiv.removeChild(headingToDelete);
            }
            var myDiv = document.getElementById("message");
            var headingToDelete = document.querySelector(".alert");
            if (headingToDelete) {
                myDiv.removeChild(headingToDelete);
            }

            var firstname = document.getElementById("firstname").value
            var lastname = document.getElementById("lastname").value
            var email = document.getElementById("email").value
            var phone = document.getElementById("phone").value

            if (firstname == '') {
                showError("First Name is Required", "danger")
                document.getElementById("loading").style.display = "none";

            }
            if (lastname == '') {
                showError("Last Name is Required", "danger")
                document.getElementById("loading").style.display = "none";

            }
            if (email == '') {
                showError("Email is Required", "danger")
                document.getElementById("loading").style.display = "none";

            }
            if (firstname != '' && lastname != '' && email != '') {
                document.getElementById("loading").style.display = "block";

                var myHeaders = new Headers();
                myHeaders.append("firstname", firstname);
                myHeaders.append("lastname", lastname);
                myHeaders.append("email", email);
                myHeaders.append("phone", phone);
                myHeaders.append("guid", id);

                var requestOptions = {
                    method: 'POST',
                    headers: myHeaders,
                    redirect: 'follow'
                };

                fetch("https://prod-32.southeastasia.logic.azure.com:443/workflows/277068ad549a4568a4b8ab73f3eddd4f/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=ngiAZ6qtk3lG-ozSR9Gj-lva22Bl3nLAo5gzWURUS9w", requestOptions)
                    .then(response => {
                        if (response.status === 200) {
                            // Registration was successful
                            showError("Success. You have been registered. You'll recieve a confirmation email shortly", "success")
                            document.getElementById("loading").style.display = "none";
                        } else {
                            // Handle other response codes (e.g., display an error message)
                            showError("Error. Already Registered.", "danger")
                            document.getElementById("loading").style.display = "none";
                        }
                    })
                    .then(result => {
                        // Do something with the result (e.g., display a success message)
                        console.log('Registration Successful:', result);
                    })
                    .catch(error => {
                        // Handle errors here (e.g., display an error message)
                        console.error('Error:', error.message);
                    });



                document.getElementById("firstname").disabled = true;
                document.getElementById("lastname").disabled = true;
                document.getElementById("email").disabled = true;
                document.getElementById("phone").disabled = true;
                document.getElementById("submit-button").style.display = "none";

            }



        };
        function showError(alert, alertType) {
            var message = document.getElementById("message");
            var messagetext = document.createElement("div");
            messagetext.classList.add("alert")
            messagetext.classList.add("alert-" + alertType)
            messagetext.textContent = alert;
            message.appendChild(messagetext);
        }
        function showError1(alert, alertType) {
            var message = document.getElementById("message1");
            var messagetext = document.createElement("div");
            messagetext.classList.add("alert")
            messagetext.classList.add("alert-" + alertType)
            messagetext.textContent = alert;
            message.appendChild(messagetext);
        }
        function hoursToDays(hours) {
            if (hours >= 24) {
                const days = Math.floor(hours / 24); // Calculate the whole number of days
                const remainingHours = hours % 24;  // Calculate the remaining hours
                if(remainingHours != 0)
                return `${days} days and ${remainingHours} hours`;
                else
                return `${days} days`;
            } else {
                return `${hours} hours`; // Less than 24 hours, return hours only
            }
        }

        // $('.nav li:first').addClass('active');

        // var showSection = function showSection(section, isAnimate) {
        //   var
        //   direction = section.replace(/#/, ''),
        //   reqSection = $('.section').filter('[data-section="' + direction + '"]'),
        //   reqSectionPos = reqSection.offset().top - 0;

        //   if (isAnimate) {
        //     $('body, html').animate({
        //       scrollTop: reqSectionPos },
        //     800);
        //   } else {
        //     $('body, html').scrollTop(reqSectionPos);
        //   }

        // };

        // var checkSection = function checkSection() {
        //   $('.section').each(function () {
        //     var
        //     $this = $(this),
        //     topEdge = $this.offset().top - 80,
        //     bottomEdge = topEdge + $this.height(),
        //     wScroll = $(window).scrollTop();
        //     if (topEdge < wScroll && bottomEdge > wScroll) {
        //       var
        //       currentId = $this.data('section'),
        //       reqLink = $('a').filter('[href*=\\#' + currentId + ']');
        //       reqLink.closest('li').addClass('active').
        //       siblings().removeClass('active');
        //     }
        //   });
        // };

        // $('.main-menu, .scroll-to-section').on('click', 'a', function (e) {
        //   if($(e.target).hasClass('external')) {
        //     return;
        //   }
        //   e.preventDefault();
        //   $('#menu').removeClass('active');
        //   showSection($(this).attr('href'), true);
        // });

        // $(window).scroll(function () {
        //   checkSection();
        // });



    </script>

</body>

</html>